# –¢–µ—Å—Ç–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ

## –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ

–Ø–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –≤ —ç—Ç–æ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ ‚Äì Rust, —á–µ–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –º–æ–∂–µ—Ç –∫–∞–∑–∞—Ç—å—Å—è —Å—Ç—Ä–∞–Ω–Ω—ã–º/–º–Ω–æ–≥–æ—Å–ª–æ–≤–Ω—ã–º. –ù–æ –ø—Ä–æ—à—É –Ω–µ –≤—ã—á–µ—Ä–∫–∏–≤–∞—Ç—å –º–µ–Ω—è —Å—Ä–∞–∑—É –∏–∑ —Å–ø–∏—Å–∫–∞ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ üòÅ. –í —Ä—É–∫–∞—Ö —á–µ–ª–æ–≤–µ–∫–∞, –∫–æ—Ç–æ—Ä—ã–π —É–º–µ–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —ç—Ç–∏–º –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–º, –æ–Ω –¥–∞–µ—Ç –æ—á–µ–Ω—å –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏, –≤ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ —Å –¥—Ä—É–≥–∏–º–∏, —á—Ç–æ –∏ –±—ã–ª–æ –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–æ –∑–¥–µ—Å—å.

Google AAID –Ω–∞–º–µ—Ä–µ–Ω–Ω–æ –Ω–µ –≤–∫–ª—é—á–µ–Ω –≤ –ø—Ä–æ–µ–∫—Ç, —Ç.–∫. —ç—Ç–æ –ø—Ä–∏–≤–µ–ª–æ –±—ã –∫ –ø–∞—Ä—Å–∏–Ω–≥—É `UserAgent` –∏–ª–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä, —Ö–µ–¥–µ—Ä—É `X-Platform` –∏ –ø—Ä–æ—á–∏—Ö —Ç—Ä—É–¥–æ–∑–∞—Ç—Ä–∞—Ç–∞—Ö, —á—Ç–æ –≤ —Ä–∞–º–∫–∞—Ö —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è –∏–∑–±—ã—Ç–æ—á–Ω–æ –∏ –∫ —Å—É—Ç–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –Ω–µ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è.

–û–¥–Ω–∞–∫–æ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ `Type-Level Design` –∑–¥–µ—Å—å –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è, —á—Ç–æ –≤—Å–µ `DeviceId` —è–≤–ª—è—é—Ç—Å—è `IDFA` –≤–º–µ—Å—Ç–µ —Å –µ–≥–æ [–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏](https://developer.apple.com/documentation/adsupport/asidentifiermanager/advertisingidentifier#discussion).

–•–æ—Ç—è –∏ –º–µ—Ç–∞–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –ø—Ä–æ–¥–∞–∫—à–Ω –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ —É—Å–∫–æ—Ä—è–µ—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É –∏ –ø–æ–¥–¥–µ—Ä–∂–∫—É, –≤ –ø—Ä–æ–µ–∫—Ç —Ç–∞–∫ –∂–µ –Ω–∞–º–µ—Ä–µ–Ω–Ω–æ –Ω–µ –≤–∫–ª—é—á–µ–Ω—ã –∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä [Validator](https://crates.io/crates/validator)), —Å —Ü–µ–ª—å—é –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø–æ–¥—Ä–æ–±–Ω–æ –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–æ—Å—Ç–∏ —Å–ª–æ—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏ (–¥–æ–º–µ–Ω–∞).

## –ó–∞–ø—É—Å–∫

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ [Rust](https://www.rust-lang.org/tools/install) –∏ [Cargo](https://doc.rust-lang.org/cargo/getting-started/installation.html).

```sh
cargo run
```

API –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É `http://localhost:8080`.

*–ë–∞–∑—É –¥–∞–Ω–Ω—ã—Ö —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è, –æ–Ω–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—ã–º–∏ –≤ –¢–ó –¥–∞–Ω–Ω—ã–º–∏ –∏ –ª–µ–∂–∏—Ç –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ [db](https://github.com/uladzikv/ab-exp/tree/main/db).*

## –°—Ç–µ–∫

- Rust
- Axum
- SQLite
- sqlx

–í –ø—Ä–æ–µ–∫—Ç–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≥–µ–∫—Å–∞–≥–æ–Ω–∞–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –≤ —Ü–µ–ª—è—Ö –ø–æ–∫–∞–∑–∞—Ç—å –Ω–∞–≤—ã–∫–∏ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.

## API

–†–µ—Å—É—Ä—Å—ã
- `experiments`
- `statistics`

### –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∫—Ä–∞–π–Ω–µ –ø—Ä–æ—Å—Ç–æ–π –º–µ—Ö–∞–Ω–∏–∑–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏. –î–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ `POST /api/experiments` –∏ `PATCH /api/experiments/:id` –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤ –∑–∞–≥–æ–ª–æ–≤–æ–∫ `Authorization` –ø–µ—Ä–µ–¥–∞—Ç—å —Ç–æ–∫–µ–Ω, –∑–∞–¥–∞–Ω–Ω—ã–π –≤ `.env`.

`POST /api/experiments`

–°–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–π —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç.

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**

```json
{
  "name": "color",
  "variants": [
      {
        "data": "blue",
        "distribution": 75
      },
      {
        "data": "red",
        "distribution": 75
      }
  ]
}
```

`PATCH /api/experiments/:id`

–û–±–Ω–æ–≤–ª—è–µ—Ç —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–º.

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**

```json
{
  "status": "finished"
}
```

`GET /api/experiments`

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤.

*–ü—Ä–∏ –ø–µ—Ä–µ–¥–∞—á–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞ `X-Device-Id` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤, –≤ –∫–æ—Ç–æ—Ä—ã—Ö —É—á–∞—Å—Ç–≤—É–µ—Ç —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–º.*
*–ï—Å–ª–∏ —É–∫–∞–∑–∞–Ω–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤–ø–µ—Ä–≤—ã–µ, —Å–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ.*

`GET /api/statistics`

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ –∏ –∏—Ö —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –ø–æ –∏—Ö –≤–∞—Ä–∏–∞–Ω—Ç–∞–º.
